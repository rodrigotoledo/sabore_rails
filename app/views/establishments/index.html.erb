<div class="w-full">
  <div class="px-4 py-6">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold text-gray-900">
        <% if params[:category].present? %>
          <%= params[:category] %>
        <% else %>
          Restaurantes
        <% end %>
      </h2>
      <%= link_to "Voltar", root_path, class: "text-yellow-600 font-semibold" %>
    </div>

    <% if notice.present? %>
      <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-md inline-block" id="notice"><%= notice %></p>
    <% end %>

    <% if @establishments.any? %>
      <div class="grid md:grid-cols-2 grid-cols-1 gap-5 w-full">
        <% @establishments.each do |establishment| %>
          <%= link_to establishment_path(establishment), class: "block" do %>
            <div class="bg-white rounded-2xl shadow-md overflow-hidden hover:shadow-xl transition">
              <div class="h-40 relative">
                <% if establishment.photos.attached? && establishment.photos.first.present? %>
                  <%= image_tag establishment.photos.first.variant(resize_to_fill: [400, 160]), class: "w-full h-full object-cover" %>
                  <div class="absolute inset-0 bg-black opacity-20"></div>
                <% else %>
                  <div class="h-full w-full bg-gradient-to-br from-yellow-300 to-yellow-500 flex items-center justify-center">
                    <!-- Ícone Lucide Utensils SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-14 h-14 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path d="M7 2v20m5-20v20m5-20v20" />
                      <circle cx="7" cy="7" r="2" />
                      <circle cx="12" cy="7" r="2" />
                      <circle cx="17" cy="7" r="2" />
                    </svg>
                  </div>
                  <div class="absolute inset-0 bg-black opacity-20"></div>
                <% end %>
                <% if establishment.establishment_type == "fast_food" %>
                  <span class="absolute top-3 right-3 bg-red-500 text-white text-xs px-3 py-1 rounded-full font-bold">FAST FOOD</span>
                <% end %>
              </div>
              <div class="p-4">
                <h3 class="font-bold text-lg text-gray-900"><%= establishment.name %></h3>
                <div class="flex items-center mt-1">
                  <span class="text-yellow-600 font-bold"><%= establishment.rating || "4.8" %></span>
                  <span class="text-yellow-500 ml-1">⭐</span>
                </div>
                <p class="text-gray-600 text-sm mt-2 line-clamp-2"><%= establishment.description || "Deliciosas opções para todos os gostos" %></p>
                <div class="flex items-center mt-3 text-sm text-gray-500">
                  <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                  </svg>
                  <span><%= establishment.address&.split(',')&.first || 'Ver no mapa' %></span>
                </div>
                <div class="flex gap-2 mt-3">
                  <%= link_to "Ver", establishment_path(establishment),
                      class: "flex-1 text-center py-2 px-3 border border-yellow-500 text-yellow-600 text-xs rounded-lg font-semibold hover:bg-yellow-50 transition" %>
                  <%= link_to "Reservar", new_reservation_path(establishment_id: establishment.id),
                      class: "flex-1 text-center py-2 px-3 bg-yellow-500 text-white text-xs rounded-lg font-semibold hover:bg-yellow-600 transition" %>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-12">
        <p class="text-gray-500 text-lg">Nenhum restaurante encontrado.</p>
        <p class="text-gray-400 mt-2">Adicione alguns no banco de dados.</p>
      </div>
    <% end %>
  </div>
</div>
